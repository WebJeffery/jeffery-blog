import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.69210375.js";const p="/jeffery-blog/assets/debug1.1e419373.png",e="/jeffery-blog/assets/debug2.92d428fa.png",o="/jeffery-blog/assets/debug3.5a4367cf.png",c="/jeffery-blog/assets/debug4.46843f8c.png",r="/jeffery-blog/assets/debug5.569999f0.png",E=JSON.parse('{"title":"Vue3 源码学习和调试","description":"","frontmatter":{},"headers":[],"relativePath":"analysis/vue3/global/debug.md","lastUpdated":1711638490000}'),t={name:"analysis/vue3/global/debug.md"},y=l(`<h1 id="vue3-源码学习和调试" tabindex="-1">Vue3 源码学习和调试 <a class="header-anchor" href="#vue3-源码学习和调试" aria-label="Permalink to &quot;Vue3 源码学习和调试&quot;">​</a></h1><h2 id="搭建源码调试环境" tabindex="-1">搭建源码调试环境 <a class="header-anchor" href="#搭建源码调试环境" aria-label="Permalink to &quot;搭建源码调试环境&quot;">​</a></h2><ol><li>克隆源码，下载到本地</li></ol><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">clone</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">git@github.com:vuejs/core.git</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="2"><li>安装依赖，使用的是 <a href="https://www.pnpm.cn/" target="_blank" rel="noreferrer">pnpm</a></li></ol><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">core</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">pnpm</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="3"><li>打包 <code>vue</code> 文件</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">pnpm run dev</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>运行 <code>pnpm run dev</code> 创建 <code>packages/vue/dist</code> 目录，生成两个文件 <code>vue.global.js</code> 和 <code>vue.global.js.map</code>，是打包后的 vue 文件</p><ol start="4"><li>启动本地服务</li></ol><p><code>ctrl + c</code> 结束进程，执行 <code>pnpm run serve</code></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">run</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">serve</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>上面命令启动一个服务，默认启动一个端口，打开 <code>localhost</code>，显示项目的目录结构界面</p><p><img src="`+p+'" alt="image.png"></p><p>进入界面事例，点击 <code>packages</code> =》 <code>vue</code> =》 <code>examples</code>，选择一个 <code>classic/todomvc</code>，进入 <code>todomvc.html</code>界面</p><p><img src="'+e+'" alt="image.png"></p><p>也可以在 <code>packages/vue/example</code> 目录下新建一个 <code>html</code> 文件，引入 <code>dist/vue.global.js</code> 文件，安装 http 服务插件 VSCode <code>Live Server</code>，在本地启动服务打开 html 文件</p><ol><li>打开浏览器开发者工具</li></ol><p>在 <code>source</code> 面板，快捷键 <code>cmd + p</code>，输入 todomvc，进入 todomvc 文件源码</p><p><img src="'+o+'" alt="image.png"></p><p><code>cmd + f</code> 搜索 <code>Vue.createApp</code>，在函数方法打上断点单步调试，进入 <code>createApp</code> 函数；</p><p>查看源码文件的路径结构，右键鼠标，选择 <code>Reveal in sidebar</code> 在左侧边栏打开</p><p><img src="'+c+'" alt="image.png"></p><p>这时可以看到 <code>createApp</code> 函数的真面目，在 <code>/packages/runtime-dom/src/index.ts</code></p><p><img src="'+r+`" alt="image.png"></p><h2 id="项目架构" tabindex="-1">项目架构 <a class="header-anchor" href="#项目架构" aria-label="Permalink to &quot;项目架构&quot;">​</a></h2><p>开始阅读源码前，先从全局的角度对框架的设计有整体的认知，否则在阅读过程中，容易被细节困住，迷失方向。</p><p>先从目录结构开始分析，了解每个模块做哪些功能，模块与模块之间是如何划分和关联的。</p><p>Vue 3 从代码结构上进行了梳理，采用 <code>monorepo</code> 单体仓库模式管理项目代码，使用 <code>pnpm workspace</code> 方式实现。它将内部实现的部分抽象成了一个个模块放在 <code>packages</code> 下，每个 <code>packages</code> 子目录都有自己的类型声明、单元测试。 package 可以独立发布，这样设计便于维护、发版和阅读。例如我们可以单独引用 <code>reactivity</code> 这个模块，在导入这些软件包时，需要 <code>@vue/</code>前缀。</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">// 目录结构分析</span></span>
<span class="line"><span style="color:#babed8;">├── .github              // github 工作流，issue 模版，代码贡献指南</span></span>
<span class="line"><span style="color:#babed8;">├── .vscode              // vscode 编辑器的配置</span></span>
<span class="line"><span style="color:#babed8;">├── packages             // vue 源码核心包，使用 pnpm workspace 工作区管理</span></span>
<span class="line"><span style="color:#babed8;">│   ├── compiler-core    // 编译器（平台无关），例如基础的 baseCompile 编译模版文件, baseParse生成AST</span></span>
<span class="line"><span style="color:#babed8;">│   ├── compiler-dom     // 基于compiler-core，专为浏览器的编译模块，可以看到它基于baseCompile，baseParse，重写了complie、parse</span></span>
<span class="line"><span style="color:#babed8;">│   ├── compiler-sfc     // 编译vue单文件组件</span></span>
<span class="line"><span style="color:#babed8;">│   ├── compiler-ssr     // 服务端渲染编译</span></span>
<span class="line"><span style="color:#babed8;">│   ├── reactivity       // vue独立的响应式模块，可以与任何框架配合,使用proxy</span></span>
<span class="line"><span style="color:#babed8;">│   ├── reactivity-transform  // 响应式实验功能，目前仅用于测试</span></span>
<span class="line"><span style="color:#babed8;">│   ├── runtime-core     // 与平台无关的运行时。有虚拟DOM渲染器，vue组件和各种API。可针对某个具体平台实现高阶runtime，比如自定义渲染器</span></span>
<span class="line"><span style="color:#babed8;">│   ├── runtime-dom      // 针对浏览器的runtime。包含处理原生DOM API</span></span>
<span class="line"><span style="color:#babed8;">│   ├── runtime-test     // 一个专门为了测试而写的轻量级 runtime。由于这个 rumtime 「渲染」出的 DOM 树其实是一个 JS 对象，所以这个 runtime 可以用在所有 JS 环境里。你可以用它来测试渲染是否正确。</span></span>
<span class="line"><span style="color:#babed8;">│   ├── server-renderer     // 服务端渲染</span></span>
<span class="line"><span style="color:#babed8;">│   ├── sfc-playground</span></span>
<span class="line"><span style="color:#babed8;">│   ├── shared             // 内部工具库,不暴露API</span></span>
<span class="line"><span style="color:#babed8;">│   ├── size-check          // 简单应用，用来测试代码体积</span></span>
<span class="line"><span style="color:#babed8;">│   ├── template-explorer  // 用于调试编译器输出的开发工具</span></span>
<span class="line"><span style="color:#babed8;">│   └── vue                 // 面向公众的完整版本, 包含运行时和编译器</span></span>
<span class="line"><span style="color:#babed8;">│   └── vue-compat          // 用于兼容 vue2</span></span>
<span class="line"><span style="color:#babed8;">│   ├── global.d.ts      // 声明文件</span></span>
<span class="line"><span style="color:#babed8;">├── scripts              // vue3脚本文件，包含配置文件，进行编译和打包等</span></span>
<span class="line"><span style="color:#babed8;">│   ├── bootstrap.js</span></span>
<span class="line"><span style="color:#babed8;">│   ├── build.js</span></span>
<span class="line"><span style="color:#babed8;">│   ├── checkYarn.js</span></span>
<span class="line"><span style="color:#babed8;">│   ├── dev.js</span></span>
<span class="line"><span style="color:#babed8;">│   ├── release.js</span></span>
<span class="line"><span style="color:#babed8;">│   ├── setupJestEnv.ts</span></span>
<span class="line"><span style="color:#babed8;">│   ├── utils.js</span></span>
<span class="line"><span style="color:#babed8;">│   └── verifyCommit.js</span></span>
<span class="line"><span style="color:#babed8;">├── test-dts             // 测试文件</span></span>
<span class="line"><span style="color:#babed8;">│   ├── README.md</span></span>
<span class="line"><span style="color:#babed8;">│   ├── component.test-d.ts</span></span>
<span class="line"><span style="color:#babed8;">│   ├── componentTypeExtensions.test-d.tsx</span></span>
<span class="line"><span style="color:#babed8;">│   ├── defineComponent.test-d.tsx</span></span>
<span class="line"><span style="color:#babed8;">│   ├── functionalComponent.test-d.tsx</span></span>
<span class="line"><span style="color:#babed8;">│   ├── h.test-d.ts</span></span>
<span class="line"><span style="color:#babed8;">│   ├── index.d.ts</span></span>
<span class="line"><span style="color:#babed8;">│   ├── inject.test-d.ts</span></span>
<span class="line"><span style="color:#babed8;">│   ├── reactivity.test-d.ts</span></span>
<span class="line"><span style="color:#babed8;">│   ├── ref.test-d.ts</span></span>
<span class="line"><span style="color:#babed8;">│   ├── setupHelpers.test-d.ts</span></span>
<span class="line"><span style="color:#babed8;">│   ├── tsconfig.build.json</span></span>
<span class="line"><span style="color:#babed8;">│   ├── tsconfig.json</span></span>
<span class="line"><span style="color:#babed8;">│   ├── tsx.test-d.tsx</span></span>
<span class="line"><span style="color:#babed8;">│   └── watch.test-d.ts</span></span>
<span class="line"><span style="color:#babed8;">├── CHANGELOG.md    // 多个版本提交记录、时间和内容</span></span>
<span class="line"><span style="color:#babed8;">├── LICENSE         // MIT协议是所有开源许可中最宽松的一个，除了必须包含许可声明外，再无任何限制。</span></span>
<span class="line"><span style="color:#babed8;">├── README.md       // 项目说明</span></span>
<span class="line"><span style="color:#babed8;">├── api-extractor.json   // 这是所有包的共享基本配置文件</span></span>
<span class="line"><span style="color:#babed8;">├── jest.config.js       // 测试配置文件</span></span>
<span class="line"><span style="color:#babed8;">├── package.json         // 项目依赖</span></span>
<span class="line"><span style="color:#babed8;">├── rollup.config.js     // rollup打包配置文件</span></span>
<span class="line"><span style="color:#babed8;">├── tsconfig.json        // 定了用来编译这个项目的根文件和编译选项</span></span>
<span class="line"><span style="color:#babed8;">├── pnpm-lock.yaml       // 锁定依赖版本</span></span>
<span class="line"><span style="color:#babed8;">└── pnpm-workspace.yaml  // pnpm 工作区</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><ul><li><code>compiler-core</code>: 编译器（平台无关），例如基础的 <code>baseCompile</code> 编译模版文件, <code>baseParse</code> 生成 AST</li><li><code>compiler-dom</code>: 基于 <code>compiler-core</code>，专为浏览器的编译模块，可以看到它基于 <code>baseCompile</code>，<code>baseParse</code>，重写了 complie、parse</li><li><code>compiler-sfc</code>: 编译 vue 单文件组件</li><li><code>compiler-ssr</code>: 服务端渲染相关的</li><li><code>reactivity</code>: vue 独立的响应式模块</li><li><code>runtime-core</code>: 也是与平台无关的基础模块，有 vue 的各类 API，虚拟 dom 的渲染器</li><li><code>runtime-dom</code>: 针对浏览器的 runtime。包含处理原生 DOM API</li><li><code>runtime-test</code>：一个专门为了测试而写的轻量级 runtime。由于这个 rumtime 「渲染」出的 DOM 树其实是一个 JS 对象，所以这个 runtime 可以用在所有 JS 环境里。你可以用它来测试渲染是否正确。</li><li><code>shared</code>：内部工具库,不暴露 API</li><li><code>size-check</code>：简单应用，用来测试代码体积</li><li><code>template-explorer</code>：用于调试编译器输出的开发工具</li><li><code>vue</code> ：面向公众的完整版本, 包含运行时和编译器</li><li><code>api-extractor.json</code> —— 所有包共享的配置文件。当我们 src 下有多个文件时，打包后会生成多个声明文件。使用 <code>@microsoft/api-extractor</code> 这个库是为了把所有的 <code>.d.ts</code> 合成一个，并且，还是可以根据写的注释自动生成文档。</li><li><code>template-explorer</code>: 用于调试编译器输出的开发工具。您可以运行 npm run dev dev template-explorer 并打开它 <code>index.html</code> 以获取基于当前源代码的模板编译的副本。在线编译网址：<code>vue-next-template-explorer.netlify.app/#</code></li></ul><h2 id="vue-源码入口" tabindex="-1">Vue 源码入口 <a class="header-anchor" href="#vue-源码入口" aria-label="Permalink to &quot;Vue 源码入口&quot;">​</a></h2><p>首先阅读 <a href="https://vuejs.org/guide/introduction.html#what-is-vue" target="_blank" rel="noreferrer">官网</a> 了解功能使用，Vue3 实例化应用不在采用 <code>new</code> 方式，而是使用 <code>createApp</code></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">createApp</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vue</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">createApp</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      count</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mount</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#app</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>从上面调试在 <code>createApp</code> 打上 debug，进入这个函数，函数位置在文件 <a href="https://github.com/vuejs/core/blob/main/packages/runtime-dom/src/index.ts#L66-L112" target="_blank" rel="noreferrer">packages/runtime-dom/src/index.ts</a></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> createApp </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> (</span><span style="color:#89DDFF;">(...</span><span style="color:#BABED8;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">app</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">ensureRenderer</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createApp</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">...</span><span style="color:#BABED8;">args</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">__DEV__</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">injectNativeTagCheck</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">app</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">injectCompilerOptionsCheck</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">app</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">mount</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">app</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mount</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">containerOrSelector</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">|</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">ShadowRoot</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">|</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">):</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">container</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">normalizeContainer</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">containerOrSelector</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#BABED8;">container</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">component</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">app</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">_component</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#82AAFF;">isFunction</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">component</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!</span><span style="color:#BABED8;">component</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">render</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!</span><span style="color:#BABED8;">component</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">template</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">__COMPAT__</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">__DEV__</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">i</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">i</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">container</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">attributes</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">length</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">i</span><span style="color:#89DDFF;">++</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">attr</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">container</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">attributes</span><span style="color:#F07178;">[</span><span style="color:#BABED8;">i</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">attr</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">name</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">v-cloak</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;font-style:italic;">^</span><span style="color:#89DDFF;">(</span><span style="color:#C3E88D;">v-</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">@</span><span style="color:#89DDFF;">)/</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">attr</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">name</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#BABED8;">compatUtils</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">warnDeprecation</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#BABED8;">DeprecationTypes</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">GLOBAL_MOUNT_CONTAINER</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#89DDFF;">null</span></span>
<span class="line"><span style="color:#F07178;">            )</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;font-style:italic;">break</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// clear content before mounting</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">container</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">innerHTML</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">proxy</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">mount</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">container</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">container</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">SVGElement</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">container</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Element</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#BABED8;">container</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">removeAttribute</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">v-cloak</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#BABED8;">container</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setAttribute</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">data-v-app</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">proxy</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">app</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">CreateAppFunction</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Element</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>上面代码 <code>createApp</code> 创建应用时调用的方法实现流程</p><ul><li><code>ensureRenderer</code> 是一个单例模式的函数，会返回一个 <code>renderer</code>，如果无 <code>renderer</code> 则会调用<code>createRenderer</code> 进行获取 <code>renderer</code> ，获得了一个 <code>app</code> 实例；</li><li>dev 环境下注册一个方法：<code>isNativeTag</code>，挂载到 <code>app.config</code> 下面；</li><li>获取到实例的 <code>mount</code> 方法，并保存下来；</li><li>重写实例的 <code>mount</code> 方法； <ul><li>调用 <code>normalizeContainer</code> 获取根元素容器；</li><li>判断 <code>template</code>，获取需要渲染的模板；</li><li>把容器的 <code>innerHTML</code> 置空；</li><li>调用上面实例的 <code>mount</code> 方法；</li><li>删除 <code>v-cloak</code> 属性，添加 <code>data-v-app</code> 属性；</li></ul></li><li>返回 mount 后的代理；</li></ul><p>从上面来看，createApp 主要做的事是调用 <code>ensureRenderer().createApp(...args) </code> 创建一个 <code>app</code> 实例，然后重写 <code>mount</code> 方法挂载，返回这个实例，整个实例化和挂载的流程很清晰，细节在后面深入研究分析。</p><p>其次，当代码逻辑比较复杂难读懂的时候，可以从测试用例入手。比如某个方法使用在官网上描述不是很清晰，想知道的更多些，比起直接深入到源码中，测试用例是一个相对快捷省时的方式。</p><p>测试文件后缀是 <code>spec</code>，例如 <code>createApp</code> 测试文件<a href="https://github.com/vuejs/core/blob/main/packages/runtime-dom/__tests__/createApp.spec.ts" target="_blank" rel="noreferrer">createApp.spec.ts</a> ，有两条测试用例</p><ul><li>可以挂载到 <code>svg</code> 元素上</li><li>不应该改变原来的根组件选项对象</li></ul><p>而且也给出对应修复的 <code>issue</code>，还可以去到 issue 上了解这个功能的背景</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">describe</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">createApp for dom</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// #2926</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mount to SVG container</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElementNS</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://www.w3.org/2000/svg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">svg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">createApp</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      render</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">h</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mount</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">root</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">root</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">children</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">length</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toBe</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">root</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">children</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">SVGElement</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toBe</span><span style="color:#F07178;">(</span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// #4398</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">should not mutate original root component options object</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">originalObj</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      data</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          counter</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">handler</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">jest</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fn</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">msg</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">msg</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatch</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">Component is missing template or render function</span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">Root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#BABED8;">originalObj</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">app</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">createApp</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">Root</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">app</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">config</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">warnHandler</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">handler</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mount</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElement</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">div</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ensure mount is based on a copy of Root object rather than Root object itself</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">app</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">_component</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">not</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toBe</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">Root</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ensure no mutation happened to Root object</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">expect</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">originalObj</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toMatchObject</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">Root</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="总结思考" tabindex="-1">总结思考 <a class="header-anchor" href="#总结思考" aria-label="Permalink to &quot;总结思考&quot;">​</a></h2><p>阅读源码，选择一个合适的工具让代码先跑起来，能够在源码上调试，然后理清楚代码组织关系及用途，单点突破，带着问题和目的去阅读，利用好单元测试。同时也要权衡利弊，该跳就跳，长期处于蒙的状态很容易走进死胡同，可以标记回头再看；利用搜索引擎，结合网上的源码分析资料理解。</p>`,46),i=[y];function F(D,b,d,m,u,B){return n(),a("div",null,i)}const g=s(t,[["render",F]]);export{E as __pageData,g as default};

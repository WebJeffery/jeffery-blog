---
title: Number 类型
date: 2021-01-07 15:03:03
permalink: /pages/seegjjasweew
author: 
  name: jeffery
categories: 
  - javascript
tags: 
  - javascript
---

# Number 类型

## 定义

`javascript`采用 `IEEE754` 格式64位的浮点数来表示数字，不区分整数和浮点数，`javascript` 中的所有数字都用浮点数值表示

由于浮点型数值需要的内存空间是保存整数值的两倍，因此 `javascript` 会不失时机地将浮点数值转换成整数值，若小数点后没有跟任何数字或者浮点值本身表示的就是一个整数，这个数值会作为整数值来保存

```js
console.log(1.0,1.0===1);//1 true
console.log(1.,1.===1);//1 true
```

## 整数

`javascript` 的整数表示共有四种字面量格式，分别是十进制、二进制、八进制、十六进制。但在进行算术计算时，所有以二进制、八进制和十六进制表示的数值最终都将被转换成十进制数值

 【1】八进制字面值的开头是 `0` 或 `0o`，后面是八进制数字序列(0-7)。如果字面值中的数值超出了范围，前导0将被忽略，后面的数值被当作十进制数解析；而 `0o` 会报错 `Uncaught SyntaxError: Invalid or unexpected token`

  注意：由于某些 `javascript` 的实现不支持八进制字面量，且八进制字面量在严格模式下是无效的，会导致 `javascript` 抛出错误。所以尽量不使用八进制字面量

  【2】十六进制字面值的前两位必须是 `0x`，后跟十六进制数字序列(0-9,a-f)，字母可大写可小写。如果十六进制中字面值中的数值超出范围，如出现g、h等会报错

  【3】二进制字面值的前两位必须是 `0b`，如果出现除0、1以外的数字会报错

```js
var num2 = 0b101;
console.log(num2);//5
var num2 = 0b2;
console.log(num2);//报错
var num8 = 012;
console.log(num8);//10
var num8 = 09;
console.log(num8);//9
var num16 = 0x11;
console.log(num16);//17
var num16 = 0xg;
console.log(num16);//报错
``` 

## 浮点数

浮点数(floating-point number)是指数值中必须包含一个小数点，且小数点后面必须至少有一位数字。与整数支持多进制不同，一般地，浮点数只可用十进制表示

```js
var num1 = 011.1;//报错
var num2 = 0x11.1;//报错
var num3 = 011e1;//报错
var num4 = 0x11e1;//出错，会被识别成整数，结果为4577
```

由于 `javascript` 采用IEEE754格式表示数字，浮点数不是精确值，所以涉及浮点数的比较和运算时要特别小心

```js
console.log(0.1 + 0.2 === 0.3);// false
console.log(0.3 / 0.1);// 2.9999999999999996
console.log((0.3 - 0.2) === (0.2 - 0.1));// false
```

## 数值精度

根据国际标准 `IEEE 754` ，`javascript` 浮点数的64个二进制位，从最左边开始，是这样组成的

```js
第1位：        符号位，0表示正数，1表示负数
第2位到第12位： 储存指数部分
第13位到第64位：储存小数部分（即有效数字）
```

符号位决定了一个数的正负，指数部分决定了数值的大小，小数部分决定了数值的精度

精度最长为53个二进制位，意味着绝对值小于2的53次方的整数，即-(2^53-1)到2^53-1，都可以精确表示

```js
Math.pow(2, 53)
// 9007199254740992
```

### 0.1+0.2 !== 0.3

计算机中的数字都是以二进制存储的，如果要计算0.1 + 0.2 的结果，计算机会先把0.1和0.2分别转化成二进制，然后相加，最后再把相加得到的结果转为十进制

把10进制的0.1转换成2进制，表示为0.0 0011 0011...(0011循环)
```js
(0.1).toString(2);//"0.0001100110011001100110011001100110011001100110011001101"
```

把10进制的0.2转换成2进制，表示为0.0011 0011...(0011循环)
```js
(0.2).toString(2);//"0.001100110011001100110011001100110011001100110011001101"
```

 由于计算机只能保存最大53位精度，所以，用科学记数法表示

  0.1的二进制为1.1001100110011001100110011001100110011001100110011010e+4(52位小数)

  0.2的二进制为1.1001100110011001100110011001100110011001100110011010e+3(52位小数)

  注意：如果第52bit和53bit都是 1，需要进位
```js
1.1001100110011001100110011001100110011001100110011010e-4
+
1.1001100110011001100110011001100110011001100110011010e-3
--------------------------------------------------------------------------
0.1100110011001100110011001100110011001100110011001101e-3
+
1.1001100110011001100110011001100110011001100110011010e-3
--------------------------------------------------------------------------
10.0110011001100110011001100110011001100110011001100111e-3
--------------------------------------------------------------------------
1.0011001100110011001100110011001100110011001100110100e-2(52位小数)
--------------------------------------------------------------------------
0.010011001100110011001100110011001100110011001100110100
转换为十进制为0.30000000000000004
```

## 数值范围

64位浮点数的指数部分的长度是11个二进制位，意味着指数部分的最大值 2047 (2^11-1), 分出一半表示负数，则 `javascript` 能够表示的数值范围为2^1024到2^-1023，超出这个范围的数无法表示 2^1024 = 1.79769*10308

`javascript` 中能表示的最大值是+-1.79769*10308，而 `javascript` 能表示的最小值是+-5*10-324

`javascript` 能够表示的整数范围是-2^53到2^53。如果超过了此范围的整数，无法保证低位数字的精度

`javascript`中的最大值保存在`Number.MAX_VALUE`中，而最小值保存在`Number.MIN_VALUE`

```js
console.log(Number.MIN_VALUE,Number.MAX_VALUE)//5e-324,1.7976931348623157e+308
```

## 特殊数值

`javascript` 提供了几个特殊数值，包括 `Number.MAX_VALUE`、`Number.MIN_VALUE`、`Number.POSITIVE_INFINITY`、`Number.NEGATIVE_INFINITY`、`Number.MAX_SAFE_INTEGER`、`Number.MIN_SAFE_INTEGER`、`Number.NaN`、`+0`、`-0`共9个

  其中，前7个特殊数值是 `Number` 对象的属性

`Number.MAX_VALUE`代表 `javascript` 最大值，`Number.MIN_VALUE` 代表`javascript`最小正值
```js
console.log(Number.MIN_VALUE,Number.MAX_VALUE)//5e-324,1.7976931348623157e+308
```

`Number.MAX_SAFE_INTEGER` 表示最大整数(2^53-1)，`Number.MIN_SAFE_INTEGER` 表示最小整数-(253-1)

```js
//9007199254740991 true
console.log(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER===Math.pow(2, 53)-1)
//-9007199254740991 true
console.log(Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER===-(Math.pow(2, 53)-1))
```

**Infinity**

`Infinity` 是一个全局属性，用来存放表示无穷大的特殊数值。用 `for/in` 循环不可枚举 `Infinity` 属性，用 `delete` 操作符也无法删除它

实际上，`Number.POSITIVE_INFINITY` 对应的是 `Infinity`，代表正无穷；而 `Number.NEGATIVE_INFINITY` 对应的是 `-Infinity`，代表负无穷

```js
console.log(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY);//Infinity -Infinity
```

`Infinity` 有正负之分
```js
Math.pow(2,Math.pow(2,100));//Infinity
1/0;//Infinity
-0/0;//-Infinity
Infinity === -Infinity;//false
```

`Infinity` 参与的运算结果只能是其本身、0或 `NaN`
```js
2 * Infinity;//Infinity
2 - Infinity;//-Infinity
2 + Infinity;//Infinity
2 / Infinity;//0
Infinity / 2;//Infinity

Infinity * Infinity;//Infinity
Infinity - Infinity;//NaN
Infinity + Infinity;//Infinity
Infinity / Infinity;//NaN
```

可以通过 `isFinite()` 来确定一个数值是不是有穷的，包含着隐式类型转换 `Number()`。如果是`+-Infinity` 或 `NaN` 时返回 `false`，否则为 `true`
```js
console.log(isFinite(Infinity))//false
console.log(isFinite(NaN))//false
console.log(isFinite(Number.MAX_VALUE))//true
console.log(isFinite(true))//true
```

**NaN**

`NaN(not a number)` 表示非数字，`NaN` 与任何值都不相等，包括 `NaN` 本身，且任何涉及 `NaN` 的操作都会返回 `NaN`
```js
5 - 'x'; //NaN
Math.acos(2); //NaN
0 / 0; //NaN

NaN == NaN;//false
NaN == Infinity;//false

[NaN].indexOf(NaN);// -1
Boolean(NaN); // false
```

`isNaN()`来判断这个数字是不是 `NaN`，包含着隐式类型转换 `Number()`

## 数值转换

有3个函数可以把非数值转换成数值：`Number()`、`parseInt()` 和 `parseFloat()`。其中 `Number()` 可以将任意类型的值转化成数值，而 `parseInt()` 和 `parseFloat()` 只应用于字符串向数字的转换

### Number()

使用 `Number()` 函数可以将任意类型的值转化成数值
```js
// 数值：十进制数字
console.log(Number(11),Number(011),Number(0x11));//11 9 17
// undefined：转成 NaN
Number(undefined) // NaN
// null：转成0
Number(null) // 0
// 布尔值：true 转成1，false 转成0
console.log(Number(true),Number(false));//1 0
```

`Number()` 函数解析字符串时会识别出字符串的前置空格并去掉

 【1】若字符串只包含十进制或十六进制数字，则转成十进制的数字

  注意1：Number()不识别八进制数字的字符串，会按照十进制数字处理

  注意2：字符串'1.2.'不会报错，但数字1.2.会报错

 【2】若字符串为空字符串或空格字符串，则转成0

 【3】其他情况的字符串，则转成NaN

```js
console.log(Number('    123'));//123
console.log(Number('1.2.'));//NaN
console.log(Number(1.2.));//报错
console.log(Number(''),Number(' '));//0 0 
console.log(Number('11'),Number('011'),Number('0x11'));//11 11 17
console.log(Number('abc'));//NaN
console.log(Number('123abc'));//NaN
```

`Number()` 函数解析对象时，会按照以下步骤进行处理

【1】调用对象的 `valueOf()` 方法，如果返回原始类型的值，则直接对该值使用 `Number()` 函数

【2】如果 `valueOf()` 方法返回的还是对象，则调用对象的 `toString()` 方法，如果返回原始类型的值，则对该值使用 `Number()` 函数

【3】如果 `toString()` 方法返回的依然是对象，则结果是 `NaN`

在第一步中，由于只有时间 `Date()` 对象返回的是原始类型的值数字，所以 `Number(new Date())` 返回现在到1970年1月1日00:00:00的数值类型的毫秒数

```js
Number(new Date())//1465976459108
```

在第二步中，数组 `Array` 类型返回由数组中每个值的字符串形式拼接而成的一个以逗号分隔的字符串，如果字符串中只存在数字，则返回数字，其他情况返回 `NaN`；由于其他对象的 `toString()` 方法返回的字符串中不只包括数字，所以返回 `NaN`

```js
Number([]);//0
Number([0]);//0
Number([-0]);//0
Number([10]);//10
Number([1,2]);//NaN
Number(其他对象);//NaN
```

### parseInt()

- `parseInt()` 专门用于把字符串转换成整数。在转换字符串时，会忽略字符串前面的空格，直到找到第一个非空格字符。如果第一个字符不是数字字符或者负号，`parseInt()` 就会返回 `NaN`。如果是，则继续解析，直到解析完成或者遇到非数字字符

```js
console.log(parseInt('    123.8px'));//123
console.log(parseInt('   123.8   '));//123
console.log(parseInt(' -123.8px'));//-123
console.log(parseInt('a123.8px'));//NaN
console.log(parseInt('0 123.8px'));//0
```

- `parseInt()` 第二个参数是进制数。这个整数只有在2到36之间，才能得到有意义的结果，超出这个范围，则返回 `NaN`。如果第二个参数是 `0`、`undefined` 和 `null`，则直接忽略

```js
console.log(parseInt('10', 37)); // NaN
console.log(parseInt('10', 1)); // NaN
console.log(parseInt('10', 0)); // 10
console.log(parseInt('10', null)); // 10
console.log(parseInt('10', undefined)); // 10
```

 如果字符串包含对于指定进制无意义的字符，则从最高位开始，只返回可以转换的数值。如果最高位无法转换，则直接返回NaN
```js
console.log(parseInt('1546', 2)); // 1
console.log(parseInt('546', 2)); // NaN
```

### parseFloat()

`parseFloat()` 专门用于字符串转换浮点数。同样地，解析时会忽略字符串前面的空格，直到找到第一个非空格字符，然后一直解析到字符串末尾或一个无效的浮点数字字符为止

```js
console.log(parseFloat('    0123.px'));//123
console.log(parseFloat('    123.px'));//123
console.log(parseFloat('    123.1px'));//123.1
console.log(parseFloat('   123.1.2px   '));//123.1
console.log(parseFloat(' -123.0px'));//-123
console.log(parseFloat('.123.1px'));//0.123
console.log(parseFloat('0 123px'));//0
```

 注意：如果字符串符合科学计数法，则会进行相应的转换

```js
console.log(parseFloat('314e-2')); // 3.14
console.log(parseFloat('0.0314E+2')); // 3.14
```

`parseFloat()` 可以识别不同进制的数字，但只能解析十进制字符串
```js
console.log(parseFloat('11'));//11
console.log(parseFloat(11));//11
console.log(parseFloat('11.1'));//11.1
console.log(parseFloat(11.1));//11.1
console.log(parseFloat('011'));//11
console.log(parseFloat(011));//9
console.log(parseFloat('011.1'));//11.1
console.log(parseFloat(011.1));//报错
console.log(parseFloat('0x11'));//0
console.log(parseFloat(0x11));//17
console.log(parseFloat('0x11.1'));//0
console.log(parseFloat(0x11.1));//报错
```

`parseFloat()` 是专门用来处理字符串转换浮点数的，`parseFloat` 处理非字符串和数字类型时输出 `NaN`。但是，实际上 `parseFloat()`包含着隐式的 `toString()` 方法，所以`parseFloat([数字或字符串])` 输出对应的数字

```js
console.log(parseFloat(null),parseFloat(undefined));//NaN NaN
console.log(parseFloat(true),parseFloat(false));//NaN NaN
console.log(parseFloat([]),parseFloat([2.1]),parseFloat(['2.1px']));//NaN 2.1 2.1 
console.log(parseFloat(''),parseFloat({}));//NaN NaN
```

::: tip
注意：`Number('')`的结果是0，`parseInt('')`和 `parseFloat('')` 的结果是 `NaN`
:::

### 实例方法

`Number()` 对象的实例方法总共有6个

**对象通用方法**

- `toString()`：将数字转换为字符串
- `toLocalString()`：将数字转换为本地惯例格式化数字的字符串
- `valueOf()` ：返回对象的数字字面量

```js
console.log(typeof 1.1.valueOf(),1.1.valueOf());//number 1.1
console.log(typeof 1.1.toString(),1.1.toString());//String '1.1'
console.log(typeof 1.1.toLocaleString(),1.1.toLocaleString());//String '1.1'
```

如果数字不加括号，点会被 `javascript` 引擎解释成小数点，从而报错
```js
console.log(typeof 1.valueOf(),1.valueOf());//报错
console.log(typeof 1.toString(),1.toString());//报错
console.log(typeof 1.toLocaleString(),1.toLocaleString());//报错

// 正确写法
console.log(typeof (1).valueOf(),(1).valueOf());//number 1
console.log(typeof (1).toString(),(1).toString());//String '1'
console.log(typeof (1).toLocaleString(),(1).toLocaleString());//String '1'
```

改变数值显示形式并转换为字符串的方法
- `toFixed()`：按照指定的小数位返回数值四舍五入后的字符串表示(常用于处理货币值)

注意：`toFixed()`里的参数只接受 0-20，若不传参或参数为 `undefined` 则相当于参数是0
```js
var num = 10.456;
console.log(num.toFixed(2));//'10.46'
console.log(num.toFixed());//'10'
console.log(num.toFixed(0));//'10'
console.log(num.toFixed(undefined));//'10'
console.log(num.toFixed(-1));//报错
```

- `toExponential()`：返回数值四舍五入后的指数表示法(e表示法)的字符串表示，参数表示转换后的小数位数

注意：`toExponential()`方法里的参数只接受0-20，但与 `toFxied()` 不同的是，若不传参或参数为`undefined`，则保留尽可能多的有效数字；若参数是0表示没有小数部分
```js
var num = 10.456;
console.log(num.toExponential(2));//'1.05e+1'
console.log(num.toExponential());//'1.0456e+1'
console.log(num.toExponential(0));//'1e+1'
console.log(num.toExponential(undefined));//'1.0456e+1'
console.log(num.toExponential(-1));//报错
```

- `toPrecision()`：接收一个参数，即表示数值的所有数字的位数(不包括指数部分)，自动调用 `toFixed()` 或 `toExponential()`

注意：`toPrecision()` 里的参数只接受1-21，若不传参或参数为 `undefined` 则相当于调用 `toString()`方法

```js
var num = 10.1;
console.log(num.toPrecision(3));//'10.1'
console.log(num.toPrecision(2));//'10'       
console.log(num.toPrecision(1));//'1e+1'
console.log(num.toPrecision());//'10.1'
console.log(num.toPrecision(undefined));//'10.1'
console.log(num.toPrecision(0));//报错
```

注意：`toFixed()`、`toExponential()`、`toPrecision()`这三个方法在小数位用于四舍五入时都不太可靠，跟浮点数不是精确储存有关

```js
console.log((12.25).toPrecision(3)); // "12.3"
console.log((12.25).toFixed(1)); // "12.3"
console.log((12.25).toExponential(2)); // "1.23e+1"
console.log((12.35).toPrecision(3)); // "12.3"
console.log((12.35).toFixed(1)); // "12.3"
console.log((12.35).toExponential(2)); // "1.23e+1"
```